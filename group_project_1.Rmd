---
title: "Statistical Inference Group Project"
author: "Dimitri Angelov, Jeeda AbuKhader, Simona Rahi"
date: "12/7/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(plotly)
```

```{r}
#Import data set
human_freedom_index <- ("~/working/data_science_folders/statistical_inference_data_science_I/project_stats/project_group_stats/hfi_cc_2018.csv")

#Have the variables read in as factors to make the interpretation easier to understand
human_freedom <- fread(human_freedom_index)
human_freedom[,1:4] <- lapply(human_freedom[,1:4], as.factor)
View(human_freedom)
names(human_freedom)
```

```{r}
#Check to see which data is missing
colSums(is.na(human_freedom))
```

```{r}
#Create personal freedom index
personal_freedom <- human_freedom %>%
select(year, ISO_code, countries, region, pf_score, pf_rank, hf_score, hf_rank) %>%  na.omit()
names(personal_freedom)
```

```{r}
#Create a religious freedom index
religious_freedom <- human_freedom %>%
select(year, ISO_code, countries, region, pf_religion, hf_score, hf_rank) %>%  na.omit()
```

```{r}
#Create an index for the regions
#Western Europe
western_europe <- subset(human_freedom, region == "Western Europe") %>% na.omit()

#Sub-Saharan Africa
sub_saharan <- subset(human_freedom, region == "Sub-Saharan Africa") %>% na.omit()

#South Asia
south_asia <- subset(human_freedom, region == "South Asia") %>% na.omit()

#Oceania
oceania <- subset(human_freedom, region == "Oceania") %>% na.omit()

#North America
north_america <- subset(human_freedom, region == "North America") %>% na.omit()

#Middle East & North Africa
middle_east <- subset(human_freedom, region == "Middle East & North Africa") %>% na.omit()

#Latin America & the Caribbean
latin_american <- subset(human_freedom, region == "Latin America & the Caribbean") %>% na.omit()

#Eastern Europe
eastern_europe <- subset(human_freedom, region == "Eastern Europe") %>% na.omit()

#East Asia
east_asia <- subset(human_freedom, region == "East Asia") %>% na.omit()

#Caucasus & Central Asia
central_asia <- subset(human_freedom, region == "Caucasus & Central Asia") %>% na.omit()
```

```{r}
#Create a categorical variable from personal freedom rank for low, medium, and high freedom levels, and have it for the years 2008 and 2016
#For year 2008
personal_freedom_2008 <- subset(personal_freedom, year = 2008)
#For year 2016
personal_freedom_2016 <- subset(personal_freedom, year = 2016)

#Freedom levels for 2008
freedom_levels_2008 <- cut(personal_freedom_2008$pf_rank, c(-1, 54, 108, 162))
levels(freedom_levels_2008) <- c("High Freedom", "Medium Freedom", "Low Freedom")
low_freedom_2008 <- subset(personal_freedom, freedom_levels_2008 == "Low Freedom")
med_freedom_2008 <- subset(personal_freedom, freedom_levels_2008 == "Medium Freedom")
high_freedom_2008 <- subset(personal_freedom, freedom_levels_2008 == "High Freedom")

#Freedom levels for 2016
freedom_levels_2016 <- cut(personal_freedom_2016$pf_rank, c(-1, 54, 108, 162))
levels(freedom_levels_2016) <- c("High Freedom", "Medium Freedom", "Low Freedom")
low_freedom_2016 <- subset(personal_freedom, freedom_levels_2016 == "Low Freedom")
med_freedom_2016 <- subset(personal_freedom, freedom_levels_2016 == "Medium Freedom")
high_freedom_2016 <- subset(personal_freedom, freedom_levels_2016 == "High Freedom")
```

```{r}
#Create a multiple linear regression line using our explanatory variables pf_rol_criminal, pf_ss_homicide, pf_movement_domestic, pf_religion_estop, pf_identity_sex against our response variable pf_score

#Model for pf_rol_criminal
criminal_model <- with(human_freedom,pf_score ~ pf_rol_criminal)
lm_criminal <- lm(formula = criminal_model, data = human_freedom)
summary(lm_criminal)
deviance(lm_criminal)

#Plot the data
plot(criminal_model)
abline(lm_criminal)

#Create a histogram
hist(lm_criminal$residuals)
par(mfrow=c(2,2))
plot(lm_criminal)
par(mfrow=c(1,1))
```

```{r}
#Model for pf_ss_homicide
homocide_model <- with(human_freedom,pf_score ~ pf_ss_homicide)
lm_homicide <- lm(formula = homocide_model, data = human_freedom)
summary(lm_homicide)
deviance(lm_homicide)

#Plot the data
plot(homocide_model)
abline(lm_homicide)

#Create a histogram
hist(lm_homicide$residuals)
par(mfrow=c(2,2))
plot(lm_homicide)
par(mfrow=c(1,1))
```

```{r}
#Model for pf_movement_domestic
movement_model <- with(human_freedom,pf_score ~ pf_movement_domestic)
lm_movement <- lm(formula = movement_model, data = human_freedom)
summary(lm_movement)
deviance(lm_movement)

#Plot the data
plot(movement_model)
abline(lm_movement)

#Create a histogram
hist(lm_movement$residuals)
par(mfrow=c(2,2))
plot(lm_movement)
par(mfrow=c(1,1))
```

```{r}
#Model for pf_religion_estop
religion_model <- with(human_freedom,pf_score ~ pf_religion_estop)
lm_religion <- lm(formula = religion_model, data = human_freedom)
summary(lm_religion)
deviance(lm_religion)

#Plot the data
plot(religion_model)
abline(lm_religion)

#Create a histogram
hist(lm_religion$residuals)
par(mfrow=c(2,2))
plot(lm_religion)
par(mfrow=c(1,1))
```

```{r}
#Model for pf_identity_sex
identity_model <- with(human_freedom,pf_score ~ pf_identity_sex)
lm_identity <- lm(formula = identity_model, data = human_freedom)
summary(lm_identity)
deviance(lm_identity)

#Plot the data
plot(identity_model)
abline(lm_identity)

#Create a histogram
hist(lm_identity$residuals)
par(mfrow=c(2,2))
plot(lm_identity)
par(mfrow=c(1,1))
```

```{r}
#Now to create a multiple linear model for all the variables
multiple_model <- with(human_freedom,pf_score ~ pf_rol_criminal + pf_ss_homicide + pf_movement_domestic + pf_religion_estop + pf_identity_sex)
lm_multiple <- lm(formula = multiple_model, data = human_freedom)
summary(lm_multiple)
deviance(lm_multiple)

#Plot the data
plot(multiple_model)

#Create a histogram
hist(lm_multiple$residuals)
par(mfrow=c(2,2))
plot(lm_multiple)
par(mfrow=c(1,1))
```


